<script>
  $(function() {
    // Create a new client to connect to Faye
    var fayeUrl = '/faye'
    // var fayeUrl = 'http://10.1.8.241:9292/faye'
    // var fayeUrl = 'https://lit-ravine-1969.herokuapp.com/faye'
    var client = new Faye.Client(fayeUrl);
    //for loalhost, all you need is var client = new Faye.Client('http://localhost:9292/faye')


// Subscribe to the public channel. This allows connected users to receive chats.this the <p> tags are going to be used  to take.  Its a method that takes in two arguments.  Where it subscribes to and then the data or mesage.(http://faye.jcoglan.com/browser/subscribing.html). this is how people receive other peoples chats.
    var public_subscription = client.subscribe('/messages/public', function(data) {
      $('<p></p>').html(data.username + ": " + data.msg).appendTo('#chat_room');
    });

     // Our own private channel. Allows an individual to receive messages on a private terminal.
    var private_subscription = client.subscribe('/messages/private/<%= session[:username] %>', function(data) {
      $('<p></p>').addClass('private').html(data.username + ": " + data.msg).appendTo('#chat_room');
    });

  });
</script>

<div class="chat_container">
  <div id="chat_room">
    <p class="alert"> Welcome to the chat room <%= current_user.name %>! </p>
  </div>

  <!-- <form id="new_message_form">
    <input type="text" id="message" name="message">
    <input type="submit" value="Send">
  </form> -->
  <%= form_tag chat_messages_path, remote: true do %>
    <%= text_field_tag :message %>
    <%= hidden_field_tag :chatroom_id, 1 %>

    <!-- we are leaving this here so that later we can dynamically call on different chatrooms. the above form should be changed to :chatroom_id , @chatroom.id instead of a value of 1-->
    <%= submit_tag "Send" %>
  <% end %>

</div>
